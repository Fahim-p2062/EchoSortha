<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoSortha: Notifications & Compliance Alerts</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        
        :root {
            --primary-color: #4CAF50;
            --accent-color: #2c3e50;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #e8f5f3 0%, #d4ebe8 100%);
        }
        
        header {
          background-color: rgba(255, 255, 255, 0.9);
          backdrop-filter: blur(5px);
          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
          padding: 20px 0;
          position: sticky;
          top: 0;
          z-index: 50;
        }
        .header-container {
          display: flex;
          justify-content: space-between;
          align-items: center;
        }
        .logo {
          display: flex;
          align-items: center;
          gap: 10px;
        }
        .logo i {
          font-size: 24px;
          color: var(--primary-color);
        }
        .logo-text {
          font-size: 1.5rem;
          font-weight: bold;
          color: var(--accent-color);
        }
        nav ul {
          display: flex;
          list-style: none;
          gap: 20px;
        }
        nav a {
            text-decoration: none;
            color: var(--accent-color);
            font-weight: 500;
            transition: all 0.3s ease;
            padding: 5px 10px;
            border-radius: 5px;
            position: relative;
        }
        nav a:hover {
          background-color: rgba(76, 175, 80, 0.1);
          color: var(--primary-color);
        }
        nav a.active {
          background-color: var(--primary-color);
          color: white;
        }
        .notif-badge {
            position: absolute;
            top: -6px;
            right: -6px;
            min-width: 18px;
            height: 18px;
            background: #ef4444;
            color: white;
            border-radius: 99px;
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 5px;
            line-height: 1;
            box-shadow: 0 0 0 2px white;
        }

        .notification-item {
            transition: all 0.2s ease;
            animation: fadeIn 0.3s ease-out;
        }
        .notification-item:hover {
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            transform: translateY(-1px);
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .border-red-500 { border-color: #ef4444; }
        .border-yellow-500 { border-color: #f59e0b; }
        .border-green-500 { border-color: #10b981; }
        .text-red-600 { color: #dc2626; }
        .text-yellow-600 { color: #d97706; }
        .text-green-600 { color: #059669; }
        .notif-muted { color: #6b7280; }
    </style>
</head>
<body class="min-h-screen">
    
    <header>
      <div class="header-container max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="logo">
          <i class="fas fa-recycle"></i>
          <div class="logo-text">EcoSortha</div>
        </div>
        <nav>
          <ul>
            <li><a href="dashboard.html">Dashboard</a></li> 
            <li><a href="https://fuzzy-capybara-5xjqq6wv7q5246qx-8000.app.github.dev/">Analytics</a></li>
            <li><a href="Dustbin.html">Dustbin</a></li>
            <li><a href="routeopt.html">Route Optimization</a></li>
            <li><a href="#" class="active" id="nav-notifications">Notifications <span id="notifBadge" class="notif-badge" style="display:none">0</span></a></li>
            <li><a href="#">Settings</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="bg-white rounded-xl shadow-2xl p-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-2 flex items-center">
                <i class="fas fa-bell mr-3 text-red-600"></i>
                Compliance & Audit Notifications
            </h2>
            <p class="text-gray-500 mb-6 border-b pb-4">
                Review automated alerts, critical system updates, and transaction confirmations. All data is auditable and tracked on the Blockchain Ledger.
            </p>

            <div class="flex gap-2 mb-4">
                <button onclick="markAllRead()" class="px-4 py-2 bg-green-600 text-white rounded">Mark All Read</button>
                <button onclick="clearRead()" class="px-4 py-2 bg-gray-200 rounded">Remove Read</button>
                <button onclick="simulateNewAlert()" class="ml-auto px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Simulate New Compliance Alert</button>
            </div>

            <div id="notificationsContainer" class="space-y-4">
                <!-- Notifications will be rendered here -->
            </div>
        </div>
    </main>

    <footer class="bg-white mt-12 py-6 border-t">
        <div class="max-w-7xl mx-auto px-4 text-center text-gray-600">
            <p>Smart Waste Management System by Team Gliders</p>
            <p class="text-sm mt-1">© 2025 All Rights Reserved</p>
        </div>
    </footer>

    <script>
        const NOTIF_KEY = 'ECO_NOTIFICATIONS_v1';

        function safeParse(jsonStr, fallback) {
            try { return JSON.parse(jsonStr); } catch(e) { return fallback; }
        }

        function loadNotifications() {
            const raw = localStorage.getItem(NOTIF_KEY);
            if (!raw) {
                const defaults = [
                    { id: Date.now()-60000, time: '5m ago', type: 'ALERT', icon: 'fas fa-exclamation-triangle', color: 'red', message: "CRITICAL ALERT: Daily Log for Mirpur Zone (Area 101) is overdue by 24 hours. Compliance Fine of ৳500 imposed.", read: false },
                    { id: Date.now()-1200000, time: '20m ago', type: 'AUDIT', icon: 'fas fa-eye', color: 'yellow', message: "AUDIT FLAG: Vendor 104 payout rate is 15% below the zone average. Review Tokai fairness.", read: true },
                    { id: Date.now()-3600000, time: '1hr ago', type: 'CONFIRMATION', icon: 'fas fa-check-circle', color: 'green', message: "BLOCK CONFIRMED: Uttara Zone (Area 102) log of 180 kg verified and added to the immutable ledger.", read: true }
                ];
                localStorage.setItem(NOTIF_KEY, JSON.stringify(defaults));
                return defaults;
            }
            return safeParse(raw, []);
        }

        function saveNotifications(list) {
            localStorage.setItem(NOTIF_KEY, JSON.stringify(list));
            renderNotifications();
            updateHeaderBadge();
            // notify other tabs/pages
            try { localStorage.setItem(NOTIF_KEY + '_lastUpdate', Date.now().toString()); } catch(e) {}
        }

        function renderNotifications() {
            const container = document.getElementById('notificationsContainer');
            const notifications = loadNotifications().slice().sort((a,b) => (b.id - a.id));
            if (notifications.length === 0) {
                container.innerHTML = '<p class="text-gray-500">No notifications.</p>';
                return;
            }

            const html = notifications.map(n => {
                const border = n.color === 'red' ? 'border-red-500' : n.color === 'yellow' ? 'border-yellow-500' : 'border-green-500';
                const textColor = n.color === 'red' ? 'text-red-600' : n.color === 'yellow' ? 'text-yellow-600' : 'text-green-600';
                const muted = n.read ? 'notif-muted' : '';
                return `
                <div class="notification-item flex p-4 rounded-xl shadow-sm border-l-4 ${border} ${n.read ? 'bg-gray-50' : 'bg-white'}">
                    <div class="flex-shrink-0 mr-4">
                        <i class="${n.icon} text-2xl ${textColor}"></i>
                    </div>
                    <div style="flex:1">
                        <p class="text-sm font-bold text-gray-800 ${muted}">${n.type} 
                            <span class="text-xs font-normal text-gray-500 ml-2">(${n.time})</span>
                        </p>
                        <p class="text-sm text-gray-600 mt-1 ${muted}">${n.message}</p>
                        <div class="mt-2 flex gap-2">
                            <button onclick="markRead(${n.id})" class="px-2 py-1 text-xs bg-green-100 rounded">Mark Read</button>
                            <button onclick="dismiss(${n.id})" class="px-2 py-1 text-xs bg-red-100 rounded">Dismiss</button>
                        </div>
                    </div>
                </div>
                `;
            }).join('');
            container.innerHTML = html;
        }

        function markRead(id) {
            const list = loadNotifications();
            const idx = list.findIndex(n => n.id === id);
            if (idx > -1) {
                list[idx].read = true;
                saveNotifications(list);
            }
        }

        function markAllRead() {
            const list = loadNotifications();
            list.forEach(n => n.read = true);
            saveNotifications(list);
        }

        function dismiss(id) {
            let list = loadNotifications();
            list = list.filter(n => n.id !== id);
            saveNotifications(list);
        }

        function clearRead() {
            let list = loadNotifications();
            list = list.filter(n => !n.read);
            saveNotifications(list);
        }

        function simulateNewAlert() {
            const list = loadNotifications();
            const newAlert = {
                id: Date.now(),
                time: 'Just Now',
                type: 'ALERT',
                icon: 'fas fa-hand-holding-usd',
                color: 'red',
                message: "EMERGENCY: Vendor 105 transaction volume reported is 500% higher than average. Possible fraudulent activity flagged. System Frozen.",
                read: false
            };
            list.unshift(newAlert);
            saveNotifications(list);
            // scroll to top highlight
            const container = document.getElementById('notificationsContainer');
            renderNotifications();
            container.firstElementChild?.classList.add('animate-pulse');
            setTimeout(() => container.firstElementChild?.classList.remove('animate-pulse'), 3000);
        }

        function updateHeaderBadge() {
            const list = loadNotifications();
            const unread = list.filter(n => !n.read).length;
            const badge = document.getElementById('notifBadge');
            if (!badge) return;
            if (unread > 0) {
                badge.style.display = 'inline-flex';
                badge.textContent = unread > 99 ? '99+' : unread;
            } else {
                badge.style.display = 'none';
            }
        }

        window.addEventListener('storage', (e) => {
            if (e.key === NOTIF_KEY || e.key === NOTIF_KEY + '_lastUpdate') {
                renderNotifications();
                updateHeaderBadge();
            }
        });

        window.addEventListener('load', () => {
            renderNotifications();
            updateHeaderBadge();
        });
    </script>
</body>
</html>